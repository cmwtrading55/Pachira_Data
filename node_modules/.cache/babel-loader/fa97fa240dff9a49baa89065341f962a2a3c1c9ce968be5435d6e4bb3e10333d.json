{"ast":null,"code":"// src/utils/Calculations.js\n\n// Function to calculate weekly summary with Monday as the start of the week and label in dd/mm/yyyy format\nexport const calculateWeeklySummary = (dailyData, tabNames) => {\n  const weeklySummary = {};\n  dailyData.forEach(row => {\n    const dateParts = row.date.split('/');\n    const [day, month, year] = dateParts.map(Number);\n    const dateObj = new Date(year, month - 1, day);\n\n    // Adjust for week starting on Monday (ISO week)\n    const dayOfWeek = (dateObj.getDay() + 6) % 7; // Monday becomes 0, Sunday becomes 6\n    const weekStart = new Date(dateObj);\n    weekStart.setDate(dateObj.getDate() - dayOfWeek); // Set to the previous Monday\n\n    // Convert weekStart to dd/mm/yyyy format for labels\n    const weekLabel = `${('0' + weekStart.getDate()).slice(-2)}/${('0' + (weekStart.getMonth() + 1)).slice(-2)}/${weekStart.getFullYear()}`;\n    if (!weeklySummary[weekLabel]) {\n      weeklySummary[weekLabel] = {\n        weekStart: weekLabel\n      }; // Label in dd/mm/yyyy format\n    }\n    tabNames.forEach(tab => {\n      weeklySummary[weekLabel][tab] = (weeklySummary[weekLabel][tab] || 0) + (row[tab] || 0);\n    });\n    weeklySummary[weekLabel].Total = (weeklySummary[weekLabel].Total || 0) + row.Total;\n  });\n  return Object.values(weeklySummary);\n};\n\n// Function to calculate all summary\nexport const calculateAllSummary = (dailyData, tabNames) => {\n  const totalSummary = {};\n  dailyData.forEach(row => {\n    tabNames.forEach(tab => {\n      totalSummary[tab] = totalSummary[tab] || {\n        totalPL: 0,\n        totalTurnover: 0,\n        roi: 0\n      };\n      totalSummary[tab].totalPL += row[tab] || 0;\n      totalSummary[tab].totalTurnover += row[`turnover_${tab}`] || 0;\n    });\n  });\n\n  // Calculate ROI and add to summary data\n  return Object.entries(totalSummary).map(([tab, totals]) => {\n    const roi = totals.totalTurnover !== 0 ? totals.totalPL / totals.totalTurnover * 100 : 0;\n    return {\n      tabName: tab,\n      totalPL: totals.totalPL,\n      totalTurnover: totals.totalTurnover,\n      roi\n    };\n  });\n};\n\n// Function to calculate total row for All Summary\nexport const calculateTotalRow = allSummaryData => {\n  const totalPL = allSummaryData.reduce((sum, row) => sum + row.totalPL, 0);\n  const totalTurnover = allSummaryData.reduce((sum, row) => sum + row.totalTurnover, 0);\n  const roi = totalTurnover !== 0 ? totalPL / totalTurnover * 100 : 0;\n  return {\n    tabName: 'Total',\n    totalPL,\n    totalTurnover,\n    roi\n  };\n};","map":{"version":3,"names":["calculateWeeklySummary","dailyData","tabNames","weeklySummary","forEach","row","dateParts","date","split","day","month","year","map","Number","dateObj","Date","dayOfWeek","getDay","weekStart","setDate","getDate","weekLabel","slice","getMonth","getFullYear","tab","Total","Object","values","calculateAllSummary","totalSummary","totalPL","totalTurnover","roi","entries","totals","tabName","calculateTotalRow","allSummaryData","reduce","sum"],"sources":["C:/Users/CMW1/Downloads/pachira-financials/src/utils/Calculations.js"],"sourcesContent":["// src/utils/Calculations.js\r\n\r\n// Function to calculate weekly summary with Monday as the start of the week and label in dd/mm/yyyy format\r\nexport const calculateWeeklySummary = (dailyData, tabNames) => {\r\n  const weeklySummary = {};\r\n\r\n  dailyData.forEach(row => {\r\n    const dateParts = row.date.split('/');\r\n    const [day, month, year] = dateParts.map(Number);\r\n    const dateObj = new Date(year, month - 1, day);\r\n\r\n    // Adjust for week starting on Monday (ISO week)\r\n    const dayOfWeek = (dateObj.getDay() + 6) % 7; // Monday becomes 0, Sunday becomes 6\r\n    const weekStart = new Date(dateObj);\r\n    weekStart.setDate(dateObj.getDate() - dayOfWeek); // Set to the previous Monday\r\n\r\n    // Convert weekStart to dd/mm/yyyy format for labels\r\n    const weekLabel = `${('0' + weekStart.getDate()).slice(-2)}/${('0' + (weekStart.getMonth() + 1)).slice(-2)}/${weekStart.getFullYear()}`;\r\n\r\n    if (!weeklySummary[weekLabel]) {\r\n      weeklySummary[weekLabel] = { weekStart: weekLabel }; // Label in dd/mm/yyyy format\r\n    }\r\n\r\n    tabNames.forEach(tab => {\r\n      weeklySummary[weekLabel][tab] = (weeklySummary[weekLabel][tab] || 0) + (row[tab] || 0);\r\n    });\r\n\r\n    weeklySummary[weekLabel].Total = (weeklySummary[weekLabel].Total || 0) + row.Total;\r\n  });\r\n\r\n  return Object.values(weeklySummary);\r\n};\r\n\r\n\r\n\r\n// Function to calculate all summary\r\nexport const calculateAllSummary = (dailyData, tabNames) => {\r\n  const totalSummary = {};\r\n\r\n  dailyData.forEach(row => {\r\n    tabNames.forEach(tab => {\r\n      totalSummary[tab] = totalSummary[tab] || { totalPL: 0, totalTurnover: 0, roi: 0 };\r\n      totalSummary[tab].totalPL += row[tab] || 0;\r\n      totalSummary[tab].totalTurnover += row[`turnover_${tab}`] || 0;\r\n    });\r\n  });\r\n\r\n  // Calculate ROI and add to summary data\r\n  return Object.entries(totalSummary).map(([tab, totals]) => {\r\n    const roi = totals.totalTurnover !== 0 ? (totals.totalPL / totals.totalTurnover) * 100 : 0;\r\n    return {\r\n      tabName: tab,\r\n      totalPL: totals.totalPL,\r\n      totalTurnover: totals.totalTurnover,\r\n      roi\r\n    };\r\n  });\r\n};\r\n\r\n// Function to calculate total row for All Summary\r\nexport const calculateTotalRow = (allSummaryData) => {\r\n  const totalPL = allSummaryData.reduce((sum, row) => sum + row.totalPL, 0);\r\n  const totalTurnover = allSummaryData.reduce((sum, row) => sum + row.totalTurnover, 0);\r\n  const roi = totalTurnover !== 0 ? (totalPL / totalTurnover) * 100 : 0;\r\n\r\n  return {\r\n    tabName: 'Total',\r\n    totalPL,\r\n    totalTurnover,\r\n    roi\r\n  };\r\n};\r\n"],"mappings":"AAAA;;AAEA;AACA,OAAO,MAAMA,sBAAsB,GAAGA,CAACC,SAAS,EAAEC,QAAQ,KAAK;EAC7D,MAAMC,aAAa,GAAG,CAAC,CAAC;EAExBF,SAAS,CAACG,OAAO,CAACC,GAAG,IAAI;IACvB,MAAMC,SAAS,GAAGD,GAAG,CAACE,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC;IACrC,MAAM,CAACC,GAAG,EAAEC,KAAK,EAAEC,IAAI,CAAC,GAAGL,SAAS,CAACM,GAAG,CAACC,MAAM,CAAC;IAChD,MAAMC,OAAO,GAAG,IAAIC,IAAI,CAACJ,IAAI,EAAED,KAAK,GAAG,CAAC,EAAED,GAAG,CAAC;;IAE9C;IACA,MAAMO,SAAS,GAAG,CAACF,OAAO,CAACG,MAAM,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;IAC9C,MAAMC,SAAS,GAAG,IAAIH,IAAI,CAACD,OAAO,CAAC;IACnCI,SAAS,CAACC,OAAO,CAACL,OAAO,CAACM,OAAO,CAAC,CAAC,GAAGJ,SAAS,CAAC,CAAC,CAAC;;IAElD;IACA,MAAMK,SAAS,GAAG,GAAG,CAAC,GAAG,GAAGH,SAAS,CAACE,OAAO,CAAC,CAAC,EAAEE,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,IAAIJ,SAAS,CAACK,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC,EAAED,KAAK,CAAC,CAAC,CAAC,CAAC,IAAIJ,SAAS,CAACM,WAAW,CAAC,CAAC,EAAE;IAEvI,IAAI,CAACrB,aAAa,CAACkB,SAAS,CAAC,EAAE;MAC7BlB,aAAa,CAACkB,SAAS,CAAC,GAAG;QAAEH,SAAS,EAAEG;MAAU,CAAC,CAAC,CAAC;IACvD;IAEAnB,QAAQ,CAACE,OAAO,CAACqB,GAAG,IAAI;MACtBtB,aAAa,CAACkB,SAAS,CAAC,CAACI,GAAG,CAAC,GAAG,CAACtB,aAAa,CAACkB,SAAS,CAAC,CAACI,GAAG,CAAC,IAAI,CAAC,KAAKpB,GAAG,CAACoB,GAAG,CAAC,IAAI,CAAC,CAAC;IACxF,CAAC,CAAC;IAEFtB,aAAa,CAACkB,SAAS,CAAC,CAACK,KAAK,GAAG,CAACvB,aAAa,CAACkB,SAAS,CAAC,CAACK,KAAK,IAAI,CAAC,IAAIrB,GAAG,CAACqB,KAAK;EACpF,CAAC,CAAC;EAEF,OAAOC,MAAM,CAACC,MAAM,CAACzB,aAAa,CAAC;AACrC,CAAC;;AAID;AACA,OAAO,MAAM0B,mBAAmB,GAAGA,CAAC5B,SAAS,EAAEC,QAAQ,KAAK;EAC1D,MAAM4B,YAAY,GAAG,CAAC,CAAC;EAEvB7B,SAAS,CAACG,OAAO,CAACC,GAAG,IAAI;IACvBH,QAAQ,CAACE,OAAO,CAACqB,GAAG,IAAI;MACtBK,YAAY,CAACL,GAAG,CAAC,GAAGK,YAAY,CAACL,GAAG,CAAC,IAAI;QAAEM,OAAO,EAAE,CAAC;QAAEC,aAAa,EAAE,CAAC;QAAEC,GAAG,EAAE;MAAE,CAAC;MACjFH,YAAY,CAACL,GAAG,CAAC,CAACM,OAAO,IAAI1B,GAAG,CAACoB,GAAG,CAAC,IAAI,CAAC;MAC1CK,YAAY,CAACL,GAAG,CAAC,CAACO,aAAa,IAAI3B,GAAG,CAAC,YAAYoB,GAAG,EAAE,CAAC,IAAI,CAAC;IAChE,CAAC,CAAC;EACJ,CAAC,CAAC;;EAEF;EACA,OAAOE,MAAM,CAACO,OAAO,CAACJ,YAAY,CAAC,CAAClB,GAAG,CAAC,CAAC,CAACa,GAAG,EAAEU,MAAM,CAAC,KAAK;IACzD,MAAMF,GAAG,GAAGE,MAAM,CAACH,aAAa,KAAK,CAAC,GAAIG,MAAM,CAACJ,OAAO,GAAGI,MAAM,CAACH,aAAa,GAAI,GAAG,GAAG,CAAC;IAC1F,OAAO;MACLI,OAAO,EAAEX,GAAG;MACZM,OAAO,EAAEI,MAAM,CAACJ,OAAO;MACvBC,aAAa,EAAEG,MAAM,CAACH,aAAa;MACnCC;IACF,CAAC;EACH,CAAC,CAAC;AACJ,CAAC;;AAED;AACA,OAAO,MAAMI,iBAAiB,GAAIC,cAAc,IAAK;EACnD,MAAMP,OAAO,GAAGO,cAAc,CAACC,MAAM,CAAC,CAACC,GAAG,EAAEnC,GAAG,KAAKmC,GAAG,GAAGnC,GAAG,CAAC0B,OAAO,EAAE,CAAC,CAAC;EACzE,MAAMC,aAAa,GAAGM,cAAc,CAACC,MAAM,CAAC,CAACC,GAAG,EAAEnC,GAAG,KAAKmC,GAAG,GAAGnC,GAAG,CAAC2B,aAAa,EAAE,CAAC,CAAC;EACrF,MAAMC,GAAG,GAAGD,aAAa,KAAK,CAAC,GAAID,OAAO,GAAGC,aAAa,GAAI,GAAG,GAAG,CAAC;EAErE,OAAO;IACLI,OAAO,EAAE,OAAO;IAChBL,OAAO;IACPC,aAAa;IACbC;EACF,CAAC;AACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}